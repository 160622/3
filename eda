import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

# Load the dataset
used_cars_df = pd.read_csv('used_cars.csv')  # Corrected function and file name

# Display the first few rows of the dataset
print("First 5 rows:")
print(used_cars_df.head())

# Basic information about the dataset
print("\nDataset Info:")
print(used_cars_df.info())

# Summary statistics for numerical columns
print("\nSummary Statistics:")
print(used_cars_df.describe())

# Check for missing values
print("\nMissing Values:")
print(used_cars_df.isnull().sum())

# Check distribution of categorical variables
print("\nCategorical Variable Distributions:")
for column in used_cars_df.select_dtypes(include='object').columns:
    print(f"\n{column}:\n{used_cars_df[column].value_counts()}")

# Visualize the distribution of numerical features
print("\nPairplot of numerical features:")
sns.pairplot(used_cars_df.select_dtypes(include=['float64', 'int64']))
plt.show()

# Correlation Matrix
correlation_matrix = used_cars_df.corr()
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.title('Correlation Matrix')
plt.show()

# Visualize the distribution of categorical variables
print("\nCountplots for categorical features:")
for column in used_cars_df.select_dtypes(include='object').columns:
    plt.figure(figsize=(8, 4))
    sns.countplot(x=column, data=used_cars_df)
    plt.title(f'Distribution of {column}')
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.show()
